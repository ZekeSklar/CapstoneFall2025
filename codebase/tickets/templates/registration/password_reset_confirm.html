<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Choose a New Password</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      :root{--bg:#f5f5f5;--card:#ffffff;--border:#d9d9de;--text:#1f2933;--muted:#6b7280;--accent:#0C4B33;--accent-secondary:#417690;--error:#b91c1c;}
      body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;max-width:520px;margin:2.5rem auto;padding:0 1.25rem;background:var(--bg);color:var(--text);}
      a{color:var(--accent-secondary);}
      .card{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:1.75rem;box-shadow:0 2px 4px rgba(12,75,51,.08);}
      h1{margin:0;font-size:1.75rem;font-weight:600;}
      p.muted{color:var(--muted);margin-top:1rem;}
      label{display:block;font-weight:600;margin-top:1.2rem;}
      input{width:100%;padding:0.65rem;border:1px solid #c7c7d1;border-radius:6px;font-size:1rem;color:var(--text);}
      input:focus{outline:2px solid rgba(65,118,144,.35);border-color:var(--accent-secondary);}
      button{margin-top:1.4rem;padding:0.75rem 1.4rem;border:0;border-radius:6px;background:var(--accent);color:#fff;font-weight:600;font-size:1rem;cursor:pointer;}
      button:hover{filter:brightness(.94);}
      .alert{background:#fdecea;border:1px solid #f5c2c7;color:var(--error);padding:0.9rem;border-radius:6px;margin-top:1rem;font-size:0.95rem;}
      .field-error{color:var(--error);font-size:0.9rem;margin-top:0.35rem;}
    </style>
  </head>
  <body>
    <div class="card">
      {% if validlink %}
        <h1>Create a new password</h1>
        <p class="muted">Enter your new password twice so we know you typed it correctly.</p>
        {% if form.non_field_errors %}
          <div class="alert">{{ form.non_field_errors|join:' ' }}</div>
        {% endif %}
        <form method="post">
          {% csrf_token %}
          {% for field in form %}
            <label for="{{ field.id_for_label }}">{{ field.label }}</label>
            {{ field }}
            {% if field.help_text %}<div class="muted" style="font-size:0.9rem;">{{ field.help_text }}</div>{% endif %}
            {% if field.errors %}<div class="field-error">{{ field.errors|join:', ' }}</div>{% endif %}
          {% endfor %}
          <button type="submit">Save new password</button>
        </form>
      {% else %}
        <h1>Link expired</h1>
        <p class="muted">This reset link is no longer valid. Please request another email below.</p>
        <a href="{% url 'password_reset' %}" style="display:inline-block;margin-top:1.4rem;padding:0.75rem 1.4rem;border-radius:6px;background:var(--accent);color:#fff;font-weight:600;text-decoration:none;">Request a new link</a>
      {% endif %}
    </div>
  </body>
</html>
